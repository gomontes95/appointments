<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Patient List</title>
    <link
          rel="stylesheet"
          href="../assets/css/materialize/materialize.min.css"
     />
    <link
          rel="stylesheet"
          href="../assets/css/patients-style.css"
     />
    <script src="../assets/js/filters/filter-by-id.js"></script>
    <script src="../assets/js/local-storage/local-storage.handler.js"></script>
    <script src="../assets/js/operaciones-conversion.js"></script>
    <script src="../assets/js/materialize/materialize.min.js"></script>
</head>

  <h3>Navigation</h3>
  <div class="div-button-container">
    <a href="patients.html" class="style-btn">Go to Patient List</a>
    <a href="appointments.html" class="style-btn">Go to Appointments</a>
    <a href="../index.html" class="style-btn">Go to Form</a>
  </div>

  <body>
    <h2>Patients

          <input
    type="text"
    id="searchBar"
    placeholder="Search Patient..."
    oninput="filterPatients()"
    style="margin-bottom: 10px; padding: 5px; width: 200px; float: right;"
    >

    </h2>
    <table class="striped highlight centered blue lighten-4" border="1" cellpadding="5">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Birthday</th>
          <th>Weight</th>
          <th>Height</th>
          <th>Age</th>
          <th>Reason</th>
          <th>Appointment</th>
        </tr>
      </thead>
      <tbody id="patientTable"></tbody>
    </table>

    <script>
    function loadPatients(filteredId) {
      let patients = localStorageHandler.getPatientList();
      let table = document.getElementById("patientTable");
      table.innerHTML = "";

      const filteredPatients = filterBy(
        filteredId,
        ['id', 'name'],
        patients,
      );

      filteredPatients.forEach((p) => {
        let row = `<tr>
          <td>${p.id}</td>
          <td>${p.name}</td>
          <td>${p.birthday}</td>
          <td>${p.weight} (${convertPoundsToKg(p.weight)} kg)</td>
          <td>${p.height} m</td>
          <td>${p.age}</td>
          <td>${p.reason}</td>
          <td>${p.appointment}</td>
        </tr>`;
        table.innerHTML += row;
      });
    }

    // âœ… Run this once when the page loads
    document.addEventListener("DOMContentLoaded", function () {
      loadPatients();

    });

    function filterPatients() {
      const id = document.getElementById('searchBar').value.trim();
      loadPatients(id);
    }
    </script>
  </body>
</html>
